@echo off
powershell -Command "Add-Type -AssemblyName System.Windows.Forms; $dllPath='AddyMouseHID.dll'; Add-Type -Path $dllPath; $m=New-Object AddyMouseHID.MouseReader; $map = @{1='L-Down'; 2='L-Up'; 4='R-Down'; 8='R-Up'; 16='M-Down'; 32='M-Up'; 64='S1-Down'; 128='S1-Up'; 256='S2-Down'; 512='S2-Up'; 2048='Tilt'}; Register-ObjectEvent -InputObject $m -EventName OnMouseDelta -SourceIdentifier 'MouseEvents'; $m.Start(); Write-Host 'Streaming to CMD... Press Ctrl+C to stop'; try { while($true) { $events = Get-Event -SourceIdentifier 'MouseEvents' -ErrorAction SilentlyContinue; if($events) { foreach($ev in $events) { $d=$ev.SourceEventArgs; $bStr = ''; foreach($key in $map.Keys){ if($d.Buttons -band $key){ $bStr += ($map[$key] + ' ') } }; if($d.Buttons -band 1024){ if($d.Wheel -gt 0){ $bStr += 'Scroll-Up ' } else { $bStr += 'Scroll-Down ' } }; if($bStr -eq ''){ $bStr = 'None' }; Write-Host ('dX: {0,4} | dY: {1,4} | Action: {2}' -f $d.X, $d.Y, $bStr.Trim()); Remove-Event -EventIdentifier $ev.EventIdentifier } }; [System.Windows.Forms.Application]::DoEvents(); Start-Sleep -m 1 } } finally { $m.Stop() }"
pause